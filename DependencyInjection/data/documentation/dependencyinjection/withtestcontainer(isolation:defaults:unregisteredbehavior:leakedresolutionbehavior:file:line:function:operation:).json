{"primaryContentSections":[{"declarations":[{"platforms":["macOS"],"tokens":[{"text":"@discardableResult","kind":"attribute"},{"text":" ","kind":"text"},{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"withTestContainer","kind":"identifier"},{"text":"<","kind":"text"},{"text":"T","kind":"genericParameter"},{"text":">(","kind":"text"},{"text":"isolation","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"isolated","kind":"keyword"},{"text":" (any ","kind":"text"},{"text":"Actor","kind":"typeIdentifier","preciseIdentifier":"s:ScA"},{"text":")? = #isolation, ","kind":"text"},{"text":"defaults","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"TestDefaults","kind":"typeIdentifier","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/TestDefaults","preciseIdentifier":"s:19DependencyInjection12TestDefaultsV"},{"text":"? = nil, ","kind":"text"},{"text":"unregisteredBehavior","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"UnregisteredBehavior","kind":"typeIdentifier","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/UnregisteredBehavior","preciseIdentifier":"s:19DependencyInjection20UnregisteredBehaviorO"},{"text":" = .fatalError, ","kind":"text"},{"text":"leakedResolutionBehavior","kind":"externalParam"},{"text":": any ","kind":"text"},{"text":"LeakedResolutionBehavior","kind":"typeIdentifier","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/LeakedResolutionBehavior","preciseIdentifier":"s:19DependencyInjection24LeakedResolutionBehaviorP"},{"text":" = DefaultLeakedResolutionBehavior(), ","kind":"text"},{"text":"file","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"},{"text":" = ","kind":"text"},{"text":"#file","kind":"keyword"},{"text":", ","kind":"text"},{"text":"line","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"UInt","kind":"typeIdentifier","preciseIdentifier":"s:Su"},{"text":" = ","kind":"text"},{"text":"#line","kind":"keyword"},{"text":", ","kind":"text"},{"text":"function","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"},{"text":" = ","kind":"text"},{"text":"#function","kind":"keyword"},{"text":", ","kind":"text"},{"text":"operation","kind":"externalParam"},{"text":": () ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"text":" -> ","kind":"text"},{"text":"T","kind":"typeIdentifier"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"rethrows","kind":"keyword"},{"text":" -> ","kind":"text"},{"text":"T","kind":"typeIdentifier"}],"languages":["swift"]}],"kind":"declarations"},{"kind":"parameters","parameters":[{"name":"isolation","content":[{"inlineContent":[{"type":"text","text":"The actor isolation context."}],"type":"paragraph"}]},{"name":"defaults","content":[{"inlineContent":[{"text":"Optional ","type":"text"},{"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/TestDefaults","isActive":true,"type":"reference"},{"text":" to pre-register in the test container.","type":"text"}],"type":"paragraph"}]},{"name":"unregisteredBehavior","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"What to do when a factory has no test double. Defaults to "},{"isActive":true,"type":"reference","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/UnregisteredBehavior\/fatalError"},{"type":"text","text":"."}]}]},{"name":"leakedResolutionBehavior","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"How to handle resolutions that escape the test scope. Defaults to "},{"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/DefaultLeakedResolutionBehavior","type":"reference","isActive":true},{"type":"text","text":"."}]}]},{"name":"file","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The file where the test container is created (for diagnostics)."}]}]},{"name":"line","content":[{"inlineContent":[{"type":"text","text":"The line where the test container is created (for diagnostics)."}],"type":"paragraph"}]},{"name":"function","content":[{"inlineContent":[{"type":"text","text":"The function where the test container is created (for diagnostics)."}],"type":"paragraph"}]},{"name":"operation","content":[{"inlineContent":[{"text":"The async test operation to execute.","type":"text"}],"type":"paragraph"}]}]},{"kind":"content","content":[{"anchor":"return-value","text":"Return Value","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"The result of the operation."}],"type":"paragraph"}]},{"kind":"content","content":[{"anchor":"discussion","type":"heading","level":2,"text":"Discussion"},{"inlineContent":[{"text":"This is the async counterpart to ","type":"text"},{"code":"withTestContainer(defaults:unregisteredBehavior:leakedResolutionBehavior:file:line:function:operation:)-1hkwu","type":"codeVoice"},{"text":".","type":"text"}],"type":"paragraph"},{"code":["@Test func asyncFeatureWorks() async {","    await withTestContainer {","        Container.networkClient.register { MockClient() }","        let result = await fetchData()","        #expect(result == .success)","    }","}"],"type":"codeListing","syntax":"swift"},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Any error thrown by the operation."}]}],"type":"aside","style":"note","name":"Throws"}]}],"kind":"symbol","abstract":[{"type":"text","text":"Executes an asynchronous test operation in an isolated container."}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/withTestContainer(isolation:defaults:unregisteredBehavior:leakedResolutionBehavior:file:line:function:operation:)"},"hierarchy":{"paths":[["doc:\/\/DependencyInjection\/documentation\/DependencyInjection"]]},"schemaVersion":{"major":0,"minor":3,"patch":0},"metadata":{"fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"withTestContainer","kind":"identifier"},{"text":"<","kind":"text"},{"text":"T","kind":"genericParameter"},{"text":">(","kind":"text"},{"text":"isolation","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"keyword","text":"isolated"},{"kind":"text","text":" (any "},{"kind":"typeIdentifier","text":"Actor","preciseIdentifier":"s:ScA"},{"kind":"text","text":")?, "},{"kind":"externalParam","text":"defaults"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"TestDefaults","preciseIdentifier":"s:19DependencyInjection12TestDefaultsV"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"unregisteredBehavior"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"UnregisteredBehavior","preciseIdentifier":"s:19DependencyInjection20UnregisteredBehaviorO"},{"kind":"text","text":", "},{"kind":"externalParam","text":"leakedResolutionBehavior"},{"kind":"text","text":": any "},{"kind":"typeIdentifier","text":"LeakedResolutionBehavior","preciseIdentifier":"s:19DependencyInjection24LeakedResolutionBehaviorP"},{"kind":"text","text":", "},{"kind":"externalParam","text":"file"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":", "},{"kind":"externalParam","text":"line"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"UInt","preciseIdentifier":"s:Su"},{"kind":"text","text":", "},{"kind":"externalParam","text":"function"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":", "},{"kind":"externalParam","text":"operation"},{"kind":"text","text":": () "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"T"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"rethrows"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"T"}],"roleHeading":"Function","remoteSource":{"url":"https:\/\/github.com\/Tyler-Keith-Thompson\/DependencyInjection\/blob\/main\/Sources\/DependencyInjection\/TestContainer.swift#L463","fileName":"TestContainer.swift"},"symbolKind":"func","role":"symbol","modules":[{"name":"DependencyInjection"}],"externalID":"s:19DependencyInjection17withTestContainer9isolation8defaults20unregisteredBehavior016leakedResolutionI04file4line8function9operationxScA_pSgYi_AA0D8DefaultsVSgAA012UnregisteredI0OAA06LeakedkI0_pSSSuSSxyYaKXEtYaKlF","title":"withTestContainer(isolation:defaults:unregisteredBehavior:leakedResolutionBehavior:file:line:function:operation:)"},"sections":[],"variants":[{"paths":["\/documentation\/dependencyinjection\/withtestcontainer(isolation:defaults:unregisteredbehavior:leakedresolutionbehavior:file:line:function:operation:)"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"doc://DependencyInjection/documentation/DependencyInjection/CrashLeakedResolutionBehavior":{"type":"topic","kind":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"CrashLeakedResolutionBehavior","kind":"identifier"}],"role":"symbol","title":"CrashLeakedResolutionBehavior","url":"\/documentation\/dependencyinjection\/crashleakedresolutionbehavior","abstract":[{"type":"text","text":"A leaked resolution behavior that always crashes with a detailed error message."}],"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/CrashLeakedResolutionBehavior","navigatorTitle":[{"text":"CrashLeakedResolutionBehavior","kind":"identifier"}]},"doc://DependencyInjection/documentation/DependencyInjection/withTestContainer(isolation:defaults:unregisteredBehavior:leakedResolutionBehavior:file:line:function:operation:)":{"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/withTestContainer(isolation:defaults:unregisteredBehavior:leakedResolutionBehavior:file:line:function:operation:)","kind":"symbol","title":"withTestContainer(isolation:defaults:unregisteredBehavior:leakedResolutionBehavior:file:line:function:operation:)","role":"symbol","url":"\/documentation\/dependencyinjection\/withtestcontainer(isolation:defaults:unregisteredbehavior:leakedresolutionbehavior:file:line:function:operation:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"withTestContainer"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"T"},{"kind":"text","text":">("},{"kind":"externalParam","text":"isolation"},{"kind":"text","text":": "},{"kind":"keyword","text":"isolated"},{"kind":"text","text":" (any "},{"kind":"typeIdentifier","preciseIdentifier":"s:ScA","text":"Actor"},{"kind":"text","text":")?, "},{"kind":"externalParam","text":"defaults"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:19DependencyInjection12TestDefaultsV","text":"TestDefaults"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"unregisteredBehavior"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:19DependencyInjection20UnregisteredBehaviorO","text":"UnregisteredBehavior"},{"kind":"text","text":", "},{"kind":"externalParam","text":"leakedResolutionBehavior"},{"kind":"text","text":": any "},{"kind":"typeIdentifier","preciseIdentifier":"s:19DependencyInjection24LeakedResolutionBehaviorP","text":"LeakedResolutionBehavior"},{"kind":"text","text":", "},{"kind":"externalParam","text":"file"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:SS","text":"String"},{"kind":"text","text":", "},{"kind":"externalParam","text":"line"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:Su","text":"UInt"},{"kind":"text","text":", "},{"kind":"externalParam","text":"function"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:SS","text":"String"},{"kind":"text","text":", "},{"kind":"externalParam","text":"operation"},{"kind":"text","text":": () "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"T"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"rethrows"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"T"}],"abstract":[{"text":"Executes an asynchronous test operation in an isolated container.","type":"text"}],"type":"topic"},"doc://DependencyInjection/documentation/DependencyInjection/TestDefaults":{"navigatorTitle":[{"text":"TestDefaults","kind":"identifier"}],"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"TestDefaults","kind":"identifier"}],"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/TestDefaults","abstract":[{"text":"A composable collection of ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/TestDefault"},{"text":" and\/or other ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/TestDefaults"},{"text":".","type":"text"}],"kind":"symbol","type":"topic","url":"\/documentation\/dependencyinjection\/testdefaults","title":"TestDefaults","role":"symbol"},"doc://DependencyInjection/documentation/DependencyInjection/LeakedResolutionBehavior":{"abstract":[{"type":"text","text":"A protocol for defining how leaked dependency resolutions are handled."}],"navigatorTitle":[{"text":"LeakedResolutionBehavior","kind":"identifier"}],"fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LeakedResolutionBehavior","kind":"identifier"}],"kind":"symbol","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/LeakedResolutionBehavior","type":"topic","role":"symbol","title":"LeakedResolutionBehavior","url":"\/documentation\/dependencyinjection\/leakedresolutionbehavior"},"doc://DependencyInjection/documentation/DependencyInjection/TestDefault":{"navigatorTitle":[{"kind":"identifier","text":"TestDefault"}],"fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"TestDefault"}],"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/TestDefault","abstract":[{"type":"text","text":"A group of "},{"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/FactoryDefault","type":"reference","isActive":true},{"type":"text","text":" values that are applied together."}],"kind":"symbol","type":"topic","url":"\/documentation\/dependencyinjection\/testdefault","title":"TestDefault","role":"symbol"},"doc://DependencyInjection/documentation/DependencyInjection":{"role":"collection","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection","abstract":[],"url":"\/documentation\/dependencyinjection","kind":"symbol","type":"topic","title":"DependencyInjection"},"doc://DependencyInjection/documentation/DependencyInjection/UnregisteredBehavior":{"title":"UnregisteredBehavior","kind":"symbol","role":"symbol","url":"\/documentation\/dependencyinjection\/unregisteredbehavior","fragments":[{"text":"enum","kind":"keyword"},{"text":" ","kind":"text"},{"text":"UnregisteredBehavior","kind":"identifier"}],"navigatorTitle":[{"kind":"identifier","text":"UnregisteredBehavior"}],"type":"topic","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/UnregisteredBehavior","abstract":[{"text":"Controls what happens when a dependency is resolved in a test container but has no registered test double.","type":"text"}]},"doc://DependencyInjection/documentation/DependencyInjection/UnregisteredBehavior/fatalError":{"kind":"symbol","title":"UnregisteredBehavior.fatalError","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/UnregisteredBehavior\/fatalError","abstract":[{"type":"text","text":"Crash immediately with a detailed error identifying the unregistered factory."}],"role":"symbol","type":"topic","url":"\/documentation\/dependencyinjection\/unregisteredbehavior\/fatalerror","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"fatalError","kind":"identifier"}]},"doc://DependencyInjection/documentation/DependencyInjection/DefaultLeakedResolutionBehavior":{"navigatorTitle":[{"kind":"identifier","text":"DefaultLeakedResolutionBehavior"}],"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/DefaultLeakedResolutionBehavior","url":"\/documentation\/dependencyinjection\/defaultleakedresolutionbehavior","kind":"symbol","title":"DefaultLeakedResolutionBehavior","abstract":[{"type":"text","text":"A leaked resolution behavior that delegates to either "},{"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/BestEffortLeakedResolutionBehavior","type":"reference","isActive":true},{"type":"text","text":" "},{"type":"text","text":"or "},{"identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/CrashLeakedResolutionBehavior","type":"reference","isActive":true},{"type":"text","text":" based on the "},{"code":"DI_BEST_EFFORT_LEAK_RESOLUTION","type":"codeVoice"},{"type":"text","text":" environment variable."}],"role":"symbol","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"DefaultLeakedResolutionBehavior"}],"type":"topic"},"doc://DependencyInjection/documentation/DependencyInjection/BestEffortLeakedResolutionBehavior":{"type":"topic","role":"symbol","identifier":"doc:\/\/DependencyInjection\/documentation\/DependencyInjection\/BestEffortLeakedResolutionBehavior","abstract":[{"text":"A leaked resolution behavior that attempts graceful recovery.","type":"text"}],"title":"BestEffortLeakedResolutionBehavior","kind":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"BestEffortLeakedResolutionBehavior","kind":"identifier"}],"url":"\/documentation\/dependencyinjection\/besteffortleakedresolutionbehavior","navigatorTitle":[{"text":"BestEffortLeakedResolutionBehavior","kind":"identifier"}]}}}